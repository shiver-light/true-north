<view class="container">
  <!-- 语言切换 -->
  <view class="langbar">
    <button class="langbtn {{lang==='zh'?'active':''}}" bindtap="switchToZh">中文</button>
    <button class="langbtn {{lang==='en'?'active':''}}" bindtap="switchToEn">EN</button>
    <text class="langhint">{{t.langHint}}</text>
  </view>

  <!-- 图层/拾取工具条 -->
  <view class="toolrow">
    <view class="switchrow">
      <text class="switchlabel">{{t.satellite}}</text>
      <switch checked="{{satellite}}" bindchange="toggleSatellite" />
    </view>

    <view class="pickbar">
      <button class="pickbtn {{pickTarget==='A'?'active':''}}" bindtap="startPickA">{{t.pickToA}}</button>
      <button class="pickbtn {{pickTarget==='B'?'active':''}}" bindtap="startPickB">{{t.pickToB}}</button>
      <button class="pickbtn" bindtap="stopPick">{{t.cancelPick}}</button>
      <text class="pickhint">
        {{ pickTarget==='none' ? t.pickHintIdle : (t.pickHintActive.replace('{target}', pickTarget)) }}
      </text>
    </view>
  </view>

  <map
    id="map"
    longitude="{{center.longitude}}"
    latitude="{{center.latitude}}"
    scale="15"
    style="width:100%;height:50vh"
    markers="{{markers}}"
    polyline="{{polyline}}"
    enable-3D="false"
    show-location="true"
    enable-satellite="{{satellite}}"
    bindtap="onMapTap"
  />

  <view class="row">
    <button type="primary" bindtap="setAFromCurrent">{{t.currentToA}}</button>
    <button bindtap="setBFromCurrent">{{t.currentToB}}</button>
    <button bindtap="gotoA" disabled="{{!A}}">{{t.gotoA}}</button>
    <button bindtap="gotoB" disabled="{{!B}}">{{t.gotoB}}</button>
  </view>

  <view class="row">
    <button type="warn" bindtap="clearAll">{{t.clearAB}}</button>
    <button bindtap="computeBearingAndDistance" disabled="{{!A || !B}}">{{t.compute}}</button>
  </view>

  <view class="panel">
    <view class="k">A：</view>
    <view class="v">{{A ? (A.latitude + ", " + A.longitude) : t.unset}}</view>
    <view class="k">{{t.altA}}</view>
    <view class="v">{{altAStr}}</view>

    <view class="k">B：</view>
    <view class="v">{{B ? (B.latitude + ", " + B.longitude) : t.unset}}</view>
    <view class="k">{{t.altB}}</view>
    <view class="v">{{altBStr}}</view>

    <view class="k">{{t.bearingLabel}}</view>
    <view class="v">{{bearingStr}}</view>

    <view class="k">{{t.distanceLabel}}</view>
    <view class="v">{{distanceStr}}</view>

    <view class="k">{{t.altDiffLabel}}</view>
    <view class="v">{{altDiffStr}}</view>
  </view>
</view>